# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - Bitrix24 + Google Gemini

## –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º:

### 1Ô∏è‚É£ Google Gemini API Key

**–ì–¥–µ –ø–æ–ª—É—á–∏—Ç—å:** https://makersuite.google.com/app/apikey

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Å—ã–ª–∫—É –≤—ã—à–µ
2. –í–æ–π–¥–∏—Ç–µ —Å Google –∞–∫–∫–∞—É–Ω—Ç–æ–º
3. –ù–∞–∂–º–∏—Ç–µ **"Create API Key"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–ª—é—á

### 2Ô∏è‚É£ Bitrix24 Webhook URL

**–ì–¥–µ —Å–æ–∑–¥–∞—Ç—å:** –í–∞—à Bitrix24 ‚Üí –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Üí –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º ‚Üí –î—Ä—É–≥–æ–µ ‚Üí –í—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫

**–ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à Bitrix24 (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è** ‚Üí **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º** ‚Üí **–î—Ä—É–≥–æ–µ** ‚Üí **–í—Ö–æ–¥—è—â–∏–π –≤–µ–±—Ö—É–∫**
3. –ù–∞–∂–º–∏—Ç–µ **"–°–æ–∑–¥–∞—Ç—å"**
4. –í —Ä–∞–∑–¥–µ–ª–µ "–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞" –Ω–∞–π–¥–∏—Ç–µ –∏ –≤–∫–ª—é—á–∏—Ç–µ:
   - ‚úÖ **AI (ai_admin)** - —ç—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!
5. –ù–∞–∂–º–∏—Ç–µ **"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"**
6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –≤–µ–±—Ö—É–∫–∞ (—Ñ–æ—Ä–º–∞—Ç: `https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru/rest/1/xxxxx/`)

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
cd bitrix24-gemini-ai
./setup.sh
```

–°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ–¥–µ—Ç –≤–∞—Å —á–µ—Ä–µ–∑ –≤—Å–µ —à–∞–≥–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

#### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
cd bitrix24-gemini-ai
npm install
```

#### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–∞

```bash
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä
cp .env.example .env

# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:

```env
# –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Gemini API Key
GEMINI_API_KEY=AIza...

# –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à Bitrix24 Webhook URL
BITRIX24_WEBHOOK_URL=https://–≤–∞—à-–¥–æ–º–µ–Ω.bitrix24.ru/rest/1/xxxxx/

# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–æ—Å—Ç–∞–≤—å—Ç–µ 3000)
PORT=3000
HOST=0.0.0.0
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª: `Ctrl+X`, –∑–∞—Ç–µ–º `Y`, –∑–∞—Ç–µ–º `Enter`

---

## üèÉ –ó–∞–ø—É—Å–∫

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

```bash
npm start
```

–î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:

```
üöÄ Bitrix24 Gemini AI Provider is running!
üì° Server: http://0.0.0.0:3000
üîó Completions endpoint: http://0.0.0.0:3000/ai/completions
‚úÖ Test endpoint: http://0.0.0.0:3000/test
üîë Gemini API Key: ‚úì Configured
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

```bash
cd bitrix24-gemini-ai

# –¢–µ—Å—Ç Gemini API
curl -X POST http://localhost:3000/test \
  -H "Content-Type: application/json" \
  -d '{"message": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"}'
```

–î–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å—Å—è –æ—Ç–≤–µ—Ç –æ—Ç Gemini.

---

## üåê –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø

Bitrix24 –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç.

### –í–∞—Ä–∏–∞–Ω—Ç A: –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å ngrok (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ)

#### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok

```bash
# –ù–∞ macOS
brew install ngrok

# –ù–∞ Linux
# –°–∫–∞—á–∞–π—Ç–µ —Å https://ngrok.com/download
```

#### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ ngrok (–≤ –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ)

```bash
ngrok http 3000
```

#### 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π URL

–í—ã —É–≤–∏–¥–∏—Ç–µ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ:

```
Forwarding   https://abc123.ngrok.io -> http://localhost:3000
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `https://abc123.ngrok.io` - —ç—Ç–æ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π URL!

‚ö†Ô∏è **–í–∞–∂–Ω–æ:** –û—Å—Ç–∞–≤—å—Ç–µ ngrok –∑–∞–ø—É—â–µ–Ω–Ω—ã–º!

### –í–∞—Ä–∏–∞–Ω—Ç B: –†–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä —Å –ø—É–±–ª–∏—á–Ω—ã–º IP –∏–ª–∏ –¥–æ–º–µ–Ω–æ–º - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ URL.

---

## üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ Bitrix24

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø—É–±–ª–∏—á–Ω–æ:

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–∞—à –ø—É–±–ª–∏—á–Ω—ã–π URL (–∏–∑ ngrok –∏–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞)
node register-ai.js https://abc123.ngrok.io
```

–£—Å–ø–µ—à–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```
‚úÖ AI-–ø—Ä–æ–≤–∞–π–¥–µ—Ä —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!
ID: 123
üìã –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
  –ù–∞–∑–≤–∞–Ω–∏–µ: Google Gemini
  –ö–æ–¥: google_gemini
  Endpoint: https://abc123.ngrok.io/ai/completions
```

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é

```bash
node list-ai.js
```

---

## üéâ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ Bitrix24

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:

### 1. –í CoPilot

1. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –≤ Bitrix24
2. –ù–∞–π–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É **CoPilot** (–æ–±—ã—á–Ω–æ –≤ –ø–∞–Ω–µ–ª–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤)
3. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö CoPilot –≤—ã–±–µ—Ä–∏—Ç–µ **"Google Gemini"**
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤!

### 2. –í –∑–∞–¥–∞—á–∞—Ö

1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
2. –í –æ–ø–∏—Å–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CoPilot
3. –ü–æ–ø—Ä–æ—Å–∏—Ç–µ Gemini –ø–æ–º–æ—á—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É

### 3. –í CRM

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å–¥–µ–ª–∫—É –∏–ª–∏ –ª–∏–¥
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CoPilot –¥–ª—è:
   - –°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–∏—Å–µ–º –∫–ª–∏–µ–Ω—Ç–∞–º
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ–ø–∏—Å–∞–Ω–∏–π
   - –°–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "GEMINI_API_KEY not configured"

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `GEMINI_API_KEY=` –∑–∞–ø–æ–ª–Ω–µ–Ω
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

### "BITRIX24_WEBHOOK_URL –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –≤–µ–±—Ö—É–∫ –≤ Bitrix24 (—Å–º. –≤—ã—à–µ)
2. –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–∞–≤–æ **ai_admin**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –≤ `.env`

### Bitrix24 –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (`npm start`)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ ngrok —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS URL –æ—Ç ngrok (–∞ –Ω–µ HTTP)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ URL –Ω–µ—Ç –æ–ø–µ—á–∞—Ç–æ–∫

### Gemini –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

‚úÖ **–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API –∫–ª—é—á –Ω–∞ https://makersuite.google.com/app/apikey
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ Gemini API
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫

---

## üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ `.env` –∏–ª–∏ –∫–æ–¥:

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–Ω–æ–≤–∞
npm start
```

–ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ –ø—É–±–ª–∏—á–Ω—ã–π URL (–Ω–æ–≤—ã–π ngrok):

```bash
# –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –∑–∞–Ω–æ–≤–æ —Å –Ω–æ–≤—ã–º URL
node register-ai.js https://–Ω–æ–≤—ã–π-url.ngrok.io
```

---

## üìû –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
2. –û—Ç–∫—Ä–æ–π—Ç–µ `README.md` –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª Troubleshooting –≤ README.md

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫

- [ ] –ü–æ–ª—É—á–µ–Ω Gemini API Key
- [ ] –°–æ–∑–¥–∞–Ω Bitrix24 Webhook —Å –ø—Ä–∞–≤–∞–º–∏ ai_admin
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`npm install`)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω `.env` —Ñ–∞–π–ª
- [ ] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (`npm start`)
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø (ngrok –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä)
- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω AI –≤ Bitrix24 (`node register-ai.js`)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (`node list-ai.js`)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –≤ Bitrix24 CoPilot

**–ì–æ—Ç–æ–≤–æ! üéâ**
